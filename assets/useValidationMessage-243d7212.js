import{r}from"./index-29a85313.js";import{V as C}from"./ValidationContext-b0a2edd5.js";import{d as O}from"./index-20667a64.js";const x=(async function(){}).constructor,m=i=>i instanceof x,d=({key:i,value:a,validateHandler:s,requireMessage:c,validationTrigger:g="onBlur"})=>{const e=r.useContext(C),[M,u]=r.useState(),n=r.useMemo(()=>{if(!c&&!s)return;const t=o=>(Array.isArray(o)&&!o.length||!o)&&c;return s&&m(s)?async o=>t(o)?c:await s(o):o=>t(o)?c:s==null?void 0:s(o)},[c,s]);r.useEffect(()=>{if(e&&i&&n)return e.set(i,m(n)?async()=>{const t=await n(a);return u(t),t}:()=>{const t=n(a);return u(t),t}),()=>{e.delete(i)}},[n,i,e,a]);const f=r.useMemo(()=>O(async t=>u(await(n==null?void 0:n(t))),300),[n]);return{...{onChange:{validateOnChange:t=>f(t)},onBlur:{validateOnBlur:()=>f(a)}}[g],validationMessage:M,validateOnChangeOption:g==="onBlur"?f:void 0,isRequried:!!c}};export{d as u};
