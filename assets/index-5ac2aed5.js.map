{"version":3,"file":"index-5ac2aed5.js","sources":["../../../src/hooks/private/useClosingState.tsx","../../../src/components/atoms/FocusLayer/index.tsx"],"sourcesContent":["import { useState } from 'react';\n\nimport { Compatibility } from '../../plugins';\n\nexport const useClosingState = (opened = false, closingDuration = 300) => {\n  const state = useState<boolean | 'closing'>(opened);\n  const [status, setStatus] = state;\n\n  Compatibility.useLayoutEffect(\n    () =>\n      setStatus(\n        opened ? true : (beforeStatus) => (beforeStatus ? 'closing' : false),\n      ),\n    [opened],\n  );\n\n  const isClosing = status === 'closing';\n  Compatibility.useLayoutEffect(() => {\n    if (isClosing) {\n      const timer = setTimeout(() => {\n        setStatus(false);\n      }, closingDuration);\n      return () => clearTimeout(timer);\n    }\n  }, [isClosing]);\n\n  return state;\n};\n","import { useEffect, useRef } from 'react';\nimport { createPortal } from 'react-dom';\n\nimport styles from './index.module.scss';\nimport { useClosingState } from '../../../hooks';\nimport { cleanClassName } from '../../../utils';\n\nexport interface FocusLayerProps {\n  children?: React.ReactNode;\n  onBlur?: () => void;\n  focused?: boolean;\n  blur?: boolean;\n  className?: string;\n  bodyScroll?: boolean;\n  priority?: 1 | 2 | 3;\n}\n\nexport const FocusLayer = ({\n  children,\n  onBlur,\n  focused,\n  blur,\n  className,\n  bodyScroll = false,\n  priority,\n}: FocusLayerProps) => {\n  const [focusStatus] = useClosingState(focused);\n  const isClosing = focusStatus === 'closing';\n\n  useEffect(() => {\n    if (!bodyScroll) {\n      const { classList } = document.body;\n      if (focused) {\n        classList.add(styles['fixed-body']);\n      }\n      return () => classList.remove(styles['fixed-body']);\n    }\n  }, [focused, bodyScroll]);\n\n  const isMouseOnFocusLayer = useRef<boolean>();\n\n  useEffect(() => {\n    if (onBlur) {\n      const handleBlur = () => {\n        if (isMouseOnFocusLayer.current === false) {\n          onBlur();\n        }\n      };\n\n      document.addEventListener('click', handleBlur);\n      return () => document.removeEventListener('click', handleBlur);\n    }\n  }, [onBlur, focusStatus]);\n\n  if (typeof window === 'undefined') {\n    return null;\n  }\n\n  return priority ? (\n    createPortal(\n      focusStatus ? (\n        <>\n          <div\n            onClick={onBlur}\n            className={cleanClassName(\n              `${styles['background-layer']} ${\n                styles[`priority-${priority}`]\n              } ${isClosing && styles.closing} ${blur && styles.blur}`,\n            )}\n          />\n          <div\n            className={cleanClassName(\n              `${styles['focus-layer']} ${styles.global} ${\n                styles[`priority-${priority}`]\n              } ${className}`,\n            )}\n          >\n            {children}\n          </div>\n        </>\n      ) : null,\n      document.body,\n    )\n  ) : (\n    <div\n      onMouseEnter={() => {\n        isMouseOnFocusLayer.current = true;\n      }}\n      onMouseLeave={() => {\n        isMouseOnFocusLayer.current = false;\n      }}\n      className={cleanClassName(`${styles['focus-layer']} ${className}`)}\n    >\n      {children}\n    </div>\n  );\n};\n"],"names":["useClosingState","opened","closingDuration","state","useState","status","setStatus","Compatibility","beforeStatus","isClosing","timer","FocusLayer","children","onBlur","focused","blur","className","bodyScroll","priority","focusStatus","useEffect","classList","styles","isMouseOnFocusLayer","useRef","handleBlur","createPortal","jsxs","Fragment","jsx","cleanClassName"],"mappings":"iQAIO,MAAMA,EAAkB,CAACC,EAAS,GAAOC,EAAkB,MAAQ,CAClE,MAAAC,EAAQC,WAA8BH,CAAM,EAC5C,CAACI,EAAQC,CAAS,EAAIH,EAEdI,EAAA,gBACZ,IACED,EACEL,EAAS,GAAQO,GAAkBA,EAAe,UAAY,EAChE,EACF,CAACP,CAAM,CAAA,EAGT,MAAMQ,EAAYJ,IAAW,UAC7B,OAAAE,EAAc,gBAAgB,IAAM,CAClC,GAAIE,EAAW,CACP,MAAAC,EAAQ,WAAW,IAAM,CAC7BJ,EAAU,EAAK,GACdJ,CAAe,EACX,MAAA,IAAM,aAAaQ,CAAK,CACjC,CAAA,EACC,CAACD,CAAS,CAAC,EAEPN,CACT,2kCCVOQ,EAAA,CAAA,CAAoB,SAAAC,EACzB,OAAAC,EACA,QAAAC,EACA,KAAAC,EACA,UAAAC,EACA,WAAAC,EAAA,GACa,SAAAC,CAEf,IAAA,CACE,KAAA,CAAAC,CAAA,EAAAnB,EAAAc,CAAA,EACAL,EAAAU,IAAA,UAEAC,EAAAA,UAAA,IAAA,CACE,GAAA,CAAAH,EAAA,CACE,KAAA,CAAA,UAAAI,CAAA,EAAA,SAAA,KACA,OAAAP,GACEO,EAAA,IAAAC,EAAA,YAAA,CAAA,EAEF,IAAAD,EAAA,OAAAC,EAAA,YAAA,CAAA,CAAkD,CACpD,EAAA,CAAAR,EAAAG,CAAA,CAAA,EAGF,MAAAM,EAAAC,EAAAA,SAeA,OAbAJ,EAAAA,UAAA,IAAA,CACE,GAAAP,EAAA,CACE,MAAAY,EAAA,IAAA,CACEF,EAAA,UAAA,IACEV,GACF,EAGF,gBAAA,iBAAA,QAAAY,CAAA,EACA,IAAA,SAAA,oBAAA,QAAAA,CAAA,CAA6D,CAC/D,EAAA,CAAAZ,EAAAM,CAAA,CAAA,EAGF,OAAA,OAAA,IACE,KAGFD,EAAAQ,EAAA,aACEP,EAAAQ,EAAA,KAAAC,WAAA,CAAA,SAAA,CAGMC,EAAA,IAAA,MAAC,CAAA,QAAAhB,EACU,UAAAiB,EACE,GAAAR,EAAA,kBAAA,CAAA,IAAAA,EAAA,YAAAJ,CAAA,EAAA,CAAA,IAAAT,GAAAa,EAAA,OAAA,IAAAP,GAAAO,EAAA,IAAA,EAG6C,CACxD,CAAA,EACFO,EAAA,IACA,MAAC,CAAA,UAAAC,EACY,GAAAR,EAAA,aAAA,CAAA,IAAAA,EAAA,MAAA,IAAAA,EAAA,YAAAJ,CAAA,EAAA,CAAA,IAAAF,CAAA,EAGI,EACf,SAAAJ,CAEC,CAAA,CACH,CAAA,CAAA,EAAA,KAEA,SAAA,IACK,EAAAiB,EAAA,IAGX,MAAC,CAAA,aAAA,IAAA,CAEGN,EAAA,QAAA,EAA8B,EAChC,aAAA,IAAA,CAEEA,EAAA,QAAA,EAA8B,EAChC,UAAAO,EAAA,GAAAR,EAAA,aAAA,CAAA,IAAAN,CAAA,EAAA,EACiE,SAAAJ,CAEhE,CAAA,CAGP"}